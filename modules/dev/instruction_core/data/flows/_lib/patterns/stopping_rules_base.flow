# Stopping Rules: Shared halt triggers and meta-rules
#
# Provides reusable stopping rule fragments for agent composition.
# This is a FRAGMENT — no @out node. Import into agent .flow files.
#
# Exported nodes:
#   @agent_file_edit_restriction  — Prohibits editing agent/prompt/instruction files (7 of 8 agents)
#   @no_edit_user_override        — Respects user "no edit" / "discussion only" requests (4 agents)
#   @verify_before_guess          — Prohibits guessing APIs or paths (2+ agents)
#   @stopping_rules_bind          — Meta-rule: stopping rules persist across entire task (ALL agents, placed in critical_rules)
#
# Usage:
#   +../_lib/patterns/stopping_rules_base.flow |.
#   +../_lib/patterns/stopping_rules_base.flow | $agent_file_edit_restriction | $no_edit_user_override |.
#
# Source: Extracted from hand-written agent files.
# Reference: agent_common_rules.instructions.md § Canonical Rule Templates § 1-3

# Used by: All agents EXCEPT HyperAgentSmith
@agent_file_edit_restriction
|<<<
NEVER edit `.agent.md`, `.prompt.md`, or `.instructions.md` files. These are managed EXCLUSIVELY by HyperAgentSmith.
>>>|.

# Used by: Agents with edit tools (HyperArch, HyperAgentSmith, HyperIQGuard, HyperDream)
@no_edit_user_override
|<<<
If the user says "no edit", "discussion only", "don't edit", "read only", or similar phrases: engage in discussion and provide guidance, but NEVER create, edit, or delete any file or folder. Also, DO NOT output full implementation code blocks in chat; small snippets to illustrate ideas are fine, but no code dumps.
>>>|.

# Used by: HyperSan, HyperArch (agents that interact with code/files)
@verify_before_guess
|<<<
STOP if you are guessing an API or path. ALWAYS verify with `search` or `read_file`.
>>>|.

# Used by: ALL agents (placed in <critical_rules>, not <stopping_rules>)
@stopping_rules_bind
|<<<
- **Stopping Rules Bind**: All `<stopping_rules>` are HARD CONSTRAINTS that persist across the entire task. Check them BEFORE each tool invocation, not just at task start.
>>>|.
