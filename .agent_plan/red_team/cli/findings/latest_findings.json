{
  "session": {
    "date": "2026-02-02",
    "target": "P0-P2.5 Implementation - UV Migration & Framework Modernization",
    "agent": "HyperRed",
    "threat_model": "internal",
    "scope": "CLI commands, module discovery, MCP server, entry points, regression checks"
  },
  "attacks_executed": [
    {
      "id": "001",
      "category": "entry_point",
      "description": "Test basic entry point - uv run adhd --help",
      "input": "uv run adhd --help",
      "result": "PASS",
      "severity": "INFO",
      "notes": "Entry point works correctly, all commands listed"
    },
    {
      "id": "002",
      "category": "cli_command",
      "description": "Test adhd list functionality",
      "input": "uv run adhd list",
      "result": "PASS",
      "severity": "INFO",
      "notes": "Lists 16 modules with correct type detection and issue warnings"
    },
    {
      "id": "003",
      "category": "boundary",
      "description": "migrate with non-existent module",
      "input": "uv run adhd migrate --module nonexistent_module",
      "result": "PASS",
      "severity": "INFO",
      "notes": "Graceful error: 'Module not found. Use adhd list to see available modules.'"
    },
    {
      "id": "004",
      "category": "boundary",
      "description": "migrate with typo (fuzzy match test)",
      "input": "uv run adhd migrate --module config_maneger",
      "result": "PASS",
      "severity": "INFO",
      "notes": "Fuzzy matching works: 'Did you mean: config_manager, temp_files_manager, logger_util?'"
    },
    {
      "id": "005",
      "category": "state",
      "description": "migrate --dry-run on already migrated modules",
      "input": "uv run adhd migrate --dry-run",
      "result": "PASS",
      "severity": "WARNING",
      "notes": "Correctly reports modules still have orphaned init.yaml files"
    },
    {
      "id": "006",
      "category": "cli_command",
      "description": "doctor check basic health",
      "input": "uv run adhd doctor",
      "result": "PASS",
      "severity": "INFO",
      "notes": "Reports 16 warnings for orphaned init.yaml files, 0 errors"
    },
    {
      "id": "007",
      "category": "error_path",
      "description": "doctor with syntactically corrupted pyproject.toml",
      "input": "Create cores/corrupt_test_core/pyproject.toml with invalid TOML",
      "result": "FAIL",
      "severity": "WARNING",
      "notes": "UV fails at parse stage before framework can handle error. UV exits with non-zero. Not a framework bug per se, but UV workspace doesn't isolate parse errors."
    },
    {
      "id": "009",
      "category": "state",
      "description": "doctor with valid minimal pyproject.toml (no [tool.adhd])",
      "input": "pyproject.toml with only [project] section",
      "result": "PASS",
      "severity": "INFO",
      "notes": "Correctly detects missing [tool.adhd] section as ERROR"
    },
    {
      "id": "010",
      "category": "boundary",
      "description": "doctor with invalid module type in [tool.adhd]",
      "input": "type = 'nonexistent_type' in pyproject.toml",
      "result": "PASS",
      "severity": "INFO",
      "notes": "Type gets overridden by folder location (cores/ -> core). Not a bug, but implicit behavior."
    },
    {
      "id": "012",
      "category": "mcp_server",
      "description": "MCP server module import and tool listing",
      "input": "Import mcp and list tools",
      "result": "PASS",
      "severity": "INFO",
      "notes": "MCP imports OK, 6 tools registered: get_project_info, list_modules, get_module_info, create_module, list_context_files, git_modules"
    },
    {
      "id": "013a",
      "category": "mcp_server",
      "description": "get_module_info with non-existent module",
      "input": "get_module_info('totally_fake_module')",
      "result": "PASS",
      "severity": "INFO",
      "notes": "Returns success=False with fuzzy match suggestions"
    },
    {
      "id": "013b",
      "category": "mcp_server",
      "description": "list_modules with invalid type filter",
      "input": "list_modules(types=['nonexistent_type'])",
      "result": "PASS",
      "severity": "INFO",
      "notes": "Returns empty list, no crash (permissive filtering)"
    },
    {
      "id": "013c",
      "category": "type_confusion",
      "description": "get_module_info with None module name",
      "input": "get_module_info(None)",
      "result": "FAIL",
      "severity": "WARNING",
      "notes": "Unhandled TypeError: argument of type 'NoneType' is not iterable. Should return error dict."
    },
    {
      "id": "014",
      "category": "error_path",
      "description": "_require_uv when UV not in PATH",
      "input": "PATH='/dev/null' then call _require_uv()",
      "result": "PASS",
      "severity": "INFO",
      "notes": "UVNotFoundError raised correctly with helpful install URL"
    },
    {
      "id": "017",
      "category": "mcp_server",
      "description": "create_module with various invalid inputs",
      "input": "Empty name, numeric start, spaces, hyphens, None, invalid type",
      "result": "FAIL",
      "severity": "BLOCKER",
      "notes": "All name validation fails with: 'ModuleCreationParams.__init__() got an unexpected keyword argument template_url'. This is a parameter mismatch between AdhdController and ModuleCreator."
    },
    {
      "id": "018",
      "category": "regression",
      "description": "refresh functionality",
      "input": "uv run adhd refresh",
      "result": "PASS",
      "severity": "INFO",
      "notes": "Refreshes all modules successfully, instruction sync works"
    },
    {
      "id": "019",
      "category": "boundary",
      "description": "refresh with non-existent module",
      "input": "uv run adhd refresh --module nonexistent_module",
      "result": "PASS",
      "severity": "INFO",
      "notes": "Graceful error with module listing hint"
    },
    {
      "id": "020a",
      "category": "mcp_server",
      "description": "git_modules with invalid action",
      "input": "git_modules(action='invalid_action')",
      "result": "PASS",
      "severity": "INFO",
      "notes": "Returns proper error: action must be one of: ['status', 'diff', 'pull', 'push']"
    },
    {
      "id": "020b",
      "category": "mcp_server",
      "description": "git_modules push without commit message",
      "input": "git_modules(action='push', module_name='config_manager')",
      "result": "PASS",
      "severity": "INFO",
      "notes": "Returns proper error: commit_message is required for push action"
    },
    {
      "id": "022",
      "category": "boundary",
      "description": "info with empty module name",
      "input": "uv run adhd info --module ''",
      "result": "PASS",
      "severity": "INFO",
      "notes": "Graceful error message"
    },
    {
      "id": "023a",
      "category": "mcp_server",
      "description": "list_context_files with invalid type",
      "input": "list_context_files(file_type='nonexistent_type')",
      "result": "PASS",
      "severity": "INFO",
      "notes": "Returns proper error: file_type must be one of: ['instruction', 'agent', 'prompt', None]"
    },
    {
      "id": "023b",
      "category": "mcp_server",
      "description": "list_context_files with valid types",
      "input": "all valid file_type values",
      "result": "PASS",
      "severity": "INFO",
      "notes": "Returns correct filtered results for each type"
    }
  ],
  "attacks_skipped": [
    {
      "category": "entry_point",
      "description": "Create-project wizard",
      "reason": "Interactive wizard requiring user input - would need mock/stdin injection. Low value for automated testing."
    },
    {
      "category": "entry_point",
      "description": "Create-module wizard",
      "reason": "Interactive wizard requiring user input - would need mock/stdin injection. Low value for automated testing."
    },
    {
      "category": "mcp_server",
      "description": "MCP stdio transport testing",
      "reason": "Requires MCP client setup. Validated via import/tool-listing instead."
    }
  ],
  "blockers_found": [
    {
      "id": "BUG-001",
      "severity": "BLOCKER",
      "component": "mcps/adhd_mcp/adhd_controller.py",
      "title": "create_module MCP tool completely broken",
      "description": "AdhdController.create_module() passes template_url parameter to ModuleCreationParams, but ModuleCreationParams does not accept this parameter. ALL module creation via MCP fails.",
      "location": "adhd_controller.py:322",
      "impact": "MCP create_module tool is 100% non-functional",
      "suggested_fix": "Remove template_url from params dict, or add template_url to ModuleCreationParams dataclass"
    }
  ],
  "warnings_found": [
    {
      "id": "WARN-001",
      "severity": "WARNING",
      "component": "mcps/adhd_mcp/adhd_controller.py",
      "title": "get_module_info crashes on None input",
      "description": "Calling get_module_info(None) throws unhandled TypeError instead of returning error dict",
      "location": "adhd_controller.py:get_module_info()",
      "suggested_fix": "Add early None check: if not module_name: return error_dict"
    },
    {
      "id": "WARN-002",
      "severity": "WARNING",
      "component": "UV workspace parsing",
      "title": "Corrupted pyproject.toml in workspace member crashes entire UV invocation",
      "description": "If any workspace member has malformed pyproject.toml, all uv commands fail. This is UV behavior, not framework code.",
      "suggested_fix": "Document that corrupt pyproject.toml in any cores/managers/utils/mcps/plugins folder will break UV. Consider validation in doctor command."
    },
    {
      "id": "WARN-003",
      "severity": "WARNING",
      "component": "modules",
      "title": "16 modules still have orphaned init.yaml files",
      "description": "Migration left init.yaml files in place. Should run actual migration to clean up.",
      "suggested_fix": "Run: adhd migrate (without --dry-run)"
    }
  ],
  "summary": {
    "total_attacks": 22,
    "passed": 19,
    "failed": 3,
    "skipped": 3,
    "blockers": 1,
    "warnings": 3,
    "assessment": "P0-P2.5 implementation is MOSTLY STABLE with ONE BLOCKER. The MCP create_module tool is completely non-functional due to parameter mismatch. CLI commands have excellent error handling and fuzzy matching. UV dependency management works. Refresh and module discovery work. Doctor command works. The blocker MUST be fixed before P3."
  }
}
